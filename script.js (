document.addEventListener('DOMContentLoaded', function() {
    const generateBtn = document.getElementById('generateBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const newVideoBtn = document.getElementById('newVideoBtn');
    const playBtn = document.getElementById('playBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const restartBtn = document.getElementById('restartBtn');
    const textInput = document.getElementById('textInput');
    const outputSection = document.getElementById('outputSection');
    const videoPreview = document.getElementById('videoPreview');
    
    let generatedVideo = null;
    let videoProgressInterval = null;
    
    // Video oluÅŸturma butonu
    generateBtn.addEventListener('click', function() {
        if (textInput.value.trim() === '') {
            alert('LÃ¼tfen video iÃ§in metin giriniz.');
            return;
        }
        
        // YÃ¼kleme ekranÄ±nÄ± gÃ¶ster
        showLoadingScreen();
        
        // SimÃ¼le edilmiÅŸ video oluÅŸturma sÃ¼reci
        simulateVideoCreation();
    });
    
    // Ä°ndirme butonu
    downloadBtn.addEventListener('click', function() {
        if (!generatedVideo) {
            alert('Ã–nce bir video oluÅŸturmalÄ±sÄ±nÄ±z.');
            return;
        }
        
        alert('Bu demo sÃ¼rÃ¼mÃ¼nde indirme iÅŸlemi simÃ¼le edilmiÅŸtir. GerÃ§ek uygulamada video indirilebilir.');
        
        // GerÃ§ek uygulamada burada video indirme iÅŸlemi yapÄ±lÄ±r
        // Ã–rnek: const url = URL.createObjectURL(generatedVideo);
        // Ã–rnek: const a = document.createElement('a');
        // Ã–rnek: a.href = url;
        // Ã–rnek: a.download = 'olusturulan-video.mp4';
        // Ã–rnek: document.body.appendChild(a);
        // Ã–rnek: a.click();
        // Ã–rnek: document.body.removeChild(a);
    });
    
    // Yeni video butonu
    newVideoBtn.addEventListener('click', function() {
        textInput.value = '';
        outputSection.style.display = 'none';
        generatedVideo = null;
        
        // SeÃ§imleri sÄ±fÄ±rla
        document.getElementById('voiceSelect').selectedIndex = 0;
        document.getElementById('styleSelect').selectedIndex = 0;
        document.getElementById('bgMusic').selectedIndex = 0;
    });
    
    // Video kontrol butonlarÄ±
    playBtn.addEventListener('click', function() {
        alert('Video oynatÄ±lÄ±yor...');
    });
    
    pauseBtn.addEventListener('click', function() {
        alert('Video duraklatÄ±ldÄ±...');
    });
    
    restartBtn.addEventListener('click', function() {
        alert('Video baÅŸa sarÄ±lÄ±yor...');
    });
    
    // YÃ¼kleme ekranÄ±nÄ± gÃ¶ster
    function showLoadingScreen() {
        videoPreview.innerHTML = `
            <div class="loading">
                <div class="spinner"></div>
                <p>Video oluÅŸturuluyor, lÃ¼tfen bekleyin...</p>
                <div class="progress-bar">
                    <div class="progress" id="progressBar"></div>
                </div>
            </div>
        `;
        
        outputSection.style.display = 'block';
        generateBtn.disabled = true;
        generateBtn.textContent = 'OluÅŸturuluyor...';
        
        // SayfayÄ± Ã§Ä±ktÄ± bÃ¶lÃ¼mÃ¼ne kaydÄ±r
        outputSection.scrollIntoView({ behavior: 'smooth' });
    }
    
    // Video oluÅŸturma simÃ¼lasyonu
    function simulateVideoCreation() {
        const progressBar = document.getElementById('progressBar');
        let progress = 0;
        
        videoProgressInterval = setInterval(function() {
            progress += 5;
            progressBar.style.width = `${progress}%`;
            
            if (progress >= 100) {
                clearInterval(videoProgressInterval);
                finishVideoCreation();
            }
        }, 200);
    }
    
    // Video oluÅŸturma tamamlandÄ±ÄŸÄ±nda
    function finishVideoCreation() {
        // YÃ¼kleme ekranÄ±nÄ± kaldÄ±r
        videoPreview.innerHTML = '';
        
        // Video Ã¶nizlemesi oluÅŸtur
        const videoElement = document.createElement('div');
        videoElement.style.width = '100%';
        videoElement.style.height = '100%';
        videoElement.style.background = 'linear-gradient(45deg, #6e8efb, #a777e3)';
        videoElement.style.display = 'flex';
        videoElement.style.alignItems = 'center';
        videoElement.style.justifyContent = 'center';
        videoElement.style.color = 'white';
        videoElement.style.fontSize = '18px';
        videoElement.style.fontWeight = 'bold';
        videoElement.innerHTML = `
            <div style="text-align: center;">
                <div style="font-size: 48px; margin-bottom: 15px;">ğŸ¬</div>
                <p>Videonuz HazÄ±r!</p>
                <p style="font-size: 14px; margin-top: 10px;">${truncateText(textInput.value, 50)}</p>
            </div>
        `;
        
        videoPreview.appendChild(videoElement);
        generatedVideo = true; // GerÃ§ek uygulamada bu bir video blob'u olurdu
        
        // ButonlarÄ± etkinleÅŸtir
        generateBtn.disabled = false;
        generateBtn.textContent = 'Video OluÅŸtur';
        
        // Ä°ndirme butonunu gÃ¶ster
        downloadBtn.style.display = 'block';
    }
    
    // Uzun metinleri kÄ±saltma
    function truncateText(text, maxLength) {
        if (text.length <= maxLength) return text;
        return text.substring(0, maxLength) + '...';
    }
    
    // Sayfa yÃ¼klendiÄŸinde yapÄ±lacaklar
    function init() {
        // Mobil cihaz kontrolÃ¼
        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            console.log("Mobil cihazda Ã§alÄ±ÅŸÄ±yor");
        }
        
        // TarayÄ±cÄ± Ã¶zellik kontrolÃ¼
        if (!('indexedDB' in window)) {
            console.log("Bu tarayÄ±cÄ± IndexedDB'yi desteklemiyor");
        }
    }
    
    // UygulamayÄ± baÅŸlat
    init();
});
